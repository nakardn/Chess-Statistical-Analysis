\documentclass[conference]{IEEEtran}
\usepackage[table]{xcolor}


\usepackage{tikz, calc}
\usepackage{cite}
\usepackage{hyperref}
\usepackage{url}
\usepackage{graphicx}
% \usepackage{svg}
\usepackage{subcaption}
\usepackage{float}
\usepackage{booktabs}
\usepackage{listings}
\lstset{
  basicstyle=\ttfamily,
  columns=fullflexible,
  frame=single,
  breaklines=true,
  postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space},
}
\usepackage{pifont}% http://ctan.org/pkg/pifont
\newcommand{\cmark}{\checkmark}%
\newcommand{\xmark}{\ding{55}}%


\graphicspath{{./figures/}}
%\graphicspath{{./tmp_figures/}}

% \let\marginpar\oldmarginpar
\setlength{\marginparwidth}{5cm}
% \newcommand{\Bnote}[1]{\textbf{[Boaz: #1]}}
\usepackage[colorinlistoftodos,prependcaption, textwidth=3cm]{todonotes}



\title{
Statistical Theory\\
Chess Dataset Analysis
}

% Authors must not appear in the submitted version. They should be hidden
% as long as the \iclrfinalcopy macro remains commented out below.
% Non-anonymous submissions will be rejected without review.

\author{
   \IEEEauthorblockN{Dor Boker, Itamar Nakar}
   \IEEEauthorblockA{
      I.D: 209271279 , 325829000\\
      Email: dorboker@gmail.com, itamar.nakar@gmail.com
   }
}

\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}

\listfiles
\begin{document}


\maketitle

\section{Introduction}
Chess is one of humanity's oldest board games \cite{chesswiki}, played by two players on an $8\times8$ grid. Each player, controlling 16 pieces of their color, aims to checkmate the opponent's King, making it impossible for the King to escape capture. Unlike many games, chess does not involve luck or hidden information; the outcome is determined solely by the players' knowledge, strategy, and analytical skills.

The length of a chess match is influenced by several factors, including the players' skill levels, strategic choices, and in-game dynamics. In this project, we investigate the relationship between player ratings and the duration of chess matches, aiming to determine whether higher-rated players tend to play shorter or longer games. In addition to player ratings, we examine other variables that may impact match length, such as opening strategies, game outcomes (win, loss, draw), and time controls.

Our dataset \cite{dataset} comprises 19,113 games from Lichess, an online chess platform, each described by 16 features. The most relevant features to our analysis are: \begin{itemize} \item \textbf{Turns}: A positive integer representing the length of the game, where one turn includes a move by both White and Black. \item \textbf{ELO Rating}: A system that quantifies player skill, widely used by FIDE and online chess platforms \cite{ELO}, which we use to assess its correlation with match length. \item \textbf{Time Controls}: Competitive games are categorized into four main time control classes: Bullet, Blitz, Rapid, and Classical, based on initial clock times and increments \cite{time}. \item \textbf{Winner and Victory Status}: These columns capture whether White or Black won and the method of victory (checkmate, resignation, draw). \end{itemize} Through statistical analysis, we aim to understand how these factors influence the duration of chess matches and to provide insights into the relationship between skill level and game dynamics. 

\section{Results}
\subsection{Data Transformation}

To optimize the quality of our analysis, we undertook a cleaning process to remove entries that could distort or obscure meaningful insights from the dataset. Below are the key transformations:

\begin{itemize}
    \item \textbf{Uncompetitive Games}: Games marked as casual or non-competitive were excluded. Such games may not reflect players' full effort or strategic depth, and are thus not representative of a standard chess match.   
 
    \item \textbf{Elo Adjustments}: New players are initially assigned an Elo rating of 1500, which can skew the distribution of player strength. To mitigate this, each player's rating was updated to reflect their most recent Elo score within the dataset.
\end{itemize}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\linewidth]{transformation_plot.png}
    \caption{Transformation's effected on Rating and Turns}
    \label{fig:transformation_plot}
\end{figure}


After these trasformations, we are left with 16,155 games which we will now begin to analyze.

\subsection{Rating Distribution}
The distribution of player ratings in the dataset initially resembles a normal distribution with a peak around the mean. However, this peak diminishes when games involving unrated players are excluded, bringing the distribution closer to normality. This is illustrated in Figure~\ref{fig:transformation_plot}. Additionally, the QQ plot (Figure~\ref{fig:rating_qq}) supports the similarity between the player rating distribution and a normal distribution, albeit with deviations at the tails, which are exacerbated by the QQ plot's sensitivity to deviations at the tail.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\linewidth]{ratingqq.png}
    \caption{Quantile - Quantile plot of white player rating in relation to normal distribution}
    \label{fig:rating_qq}
\end{figure}


\subsubsection*{Kolmogorov-Smirnov (KS) Test for Normality}
We applied the Kolmogorov-Smirnov (KS) test to evaluate whether the player rating distribution follows a normal distribution. The test returned a p-value of \(8.9649 \times 10^{-13}\), which is significantly lower than the threshold of \(0.03\) for a confidence level of 97\%, thus rejecting the null hypothesis that the rating distribution is normally distributed. However, when the test was performed on a random 10\% sample of player ratings, the p-value increased to 0.49, meaning we could not reject the null hypothesis at that sample size. This result indicates that while the entire population does not fit a normal distribution, smaller samples may approximate normality \cite{kssample}.


\subsection{Relations Between Features}
Analyzing the datasetâ€™s correlation matrix reveals linear relationships between certain features. For example, there is a weak positive correlation between the players' average rating and game length. There are also weak negative correlations between the number of turns and both the absolute difference in player ratings and the 'winner' variable, where 'winner' is numerized as 0 for draws and 1 for games with a winner. From these correlations, we can tentatively conclude that:
\begin{itemize}
    \item Games involving more skilled players tend to last longer.
 
    \item Games with a larger skill gap between players may end faster.

    \item Draws tend to draw out longer then desicive games.
\end{itemize}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\linewidth]{corr_mat.png}
    \caption{Heat map of the correlation matrix}
    \label{fig:corr_mat}
\end{figure}

\subsection{Connection Between Player Rating and Game Length}
To investigate whether player ratings are associated with game length, we divided players into two groups based on their ratings: those with ratings higher than 1500 (high-rated) and those with ratings lower than 1500 (low-rated). The threshold of 1500 was chosen because it represents the starting rating on the Lichess platform. The empirical cumulative distribution function (ECDF) of game lengths for both groups (Figure~\ref{fig:ecdf_plot}) shows that high-rated players generally play longer games.

\subsubsection*{Mann-Whitney U Test for Game Length}
Since we could not confirm the normality of the rating distribution, we applied the non-parametric Mann-Whitney U test to compare the game lengths between high-rated and low-rated players. Our null hypothesis was that high-rated players do not play longer games than low-rated players on average. The test returned a p-value of \(2.7 \times 10^{-73}\), which allows us to reject the null hypothesis. Therefore, we conclude that player rating significantly influences game length, with higher-rated players tending to play longer games.


\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\linewidth]{gamma_fit.png}
    \caption{Gamma distribution fitted to the 'Turns' data}
    \label{fig:gamma_fit}
\end{figure}
\subsection{Distribution of 'Turns'}

To better understand the distribution of the 'Turns' variable, we attempted to fit it to several probability distribution families. The Gamma distribution was selected first due to its ability to model skewed data. However, as shown in Figure \ref{fig:gamma_fit}, the Gamma distribution is too broad for this dataset, suggesting it does not fully capture the underlying structure of 'Turns.'

To refine the fit, we combined the Gamma distribution with a Poisson distribution, which has a narrower shape. This combination results in a more accurate fit to the empirical data, as shown in Figure \ref{fig:gam_poi_fit}. The Gamma-Poisson mixture balances the excess spread of the Gamma distribution with the narrowness of the Poisson, providing a better representation of the 'Turns' distribution.



\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\linewidth]{gam_poi_fit.png}
    \caption{Gamma-Poisson distribution fitted to the 'Turns' data}
    \label{fig:gam_poi_fit}
\end{figure}



\newpage
\bibliographystyle{IEEEtran}
\bibliography{references}

\end{document}
